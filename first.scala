changing whole code and merging branch 11 added here